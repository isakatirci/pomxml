MÃ¼kemmel! DosyalarÄ± inceledim. Åimdi size profesyonel bir **SOAP Mock Server** projesi oluÅŸturacaÄŸÄ±m. Bu SWIFT camt.053 mesajÄ±nÄ± dÃ¶ndÃ¼ren bir mock server olacak.

## ğŸ“ Proje YapÄ±sÄ±

```
soap-mock-server/
â”œâ”€â”€ pom.xml
â”œâ”€â”€ README.md
â””â”€â”€ src/
    â”œâ”€â”€ main/
    â”‚   â”œâ”€â”€ java/
    â”‚   â”‚   â””â”€â”€ com/
    â”‚   â”‚       â””â”€â”€ example/
    â”‚   â”‚           â””â”€â”€ soapmock/
    â”‚   â”‚               â”œâ”€â”€ SoapMockServerApplication.java
    â”‚   â”‚               â”œâ”€â”€ config/
    â”‚   â”‚               â”‚   â”œâ”€â”€ WebServiceConfig.java
    â”‚   â”‚               â”‚   â””â”€â”€ SoapLoggingInterceptor.java
    â”‚   â”‚               â””â”€â”€ endpoint/
    â”‚   â”‚                   â””â”€â”€ MockSoapEndpoint.java
    â”‚   â””â”€â”€ resources/
    â”‚       â”œâ”€â”€ application.yml
    â”‚       â”œâ”€â”€ wsdl/
    â”‚       â”‚   â””â”€â”€ soapha.wsdl
    â”‚       â””â”€â”€ mock/
    â”‚           â””â”€â”€ response.xml
    â””â”€â”€ test/
        â””â”€â”€ java/
            â””â”€â”€ com/
                â””â”€â”€ example/
                    â””â”€â”€ soapmock/
                        â””â”€â”€ SoapMockServerApplicationTests.java
```

## 1ï¸âƒ£ **pom.xml**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
         https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.2.0</version>
        <relativePath/>
    </parent>

    <groupId>com.example</groupId>
    <artifactId>soap-mock-server</artifactId>
    <version>1.0.0</version>
    <name>SOAP Mock Server</name>
    <description>SWIFT SOAP Mock Server for camt.053 Messages</description>

    <properties>
        <java.version>17</java.version>
        <maven.compiler.source>17</maven.compiler.source>
        <maven.compiler.target>17</maven.compiler.target>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    </properties>

    <dependencies>
        <!-- Spring Boot Web Services -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web-services</artifactId>
        </dependency>

        <!-- WSDL Support -->
        <dependency>
            <groupId>wsdl4j</groupId>
            <artifactId>wsdl4j</artifactId>
        </dependency>

        <!-- Lombok for cleaner code -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>

        <!-- Spring Boot Actuator for health checks -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>

        <!-- Test Dependencies -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.springframework.ws</groupId>
            <artifactId>spring-ws-test</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
```

## 2ï¸âƒ£ **SoapMockServerApplication.java**

```java
package com.example.soapmock;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

/**
 * SOAP Mock Server Application
 * Provides mock responses for SWIFT camt.053 messages
 */
@SpringBootApplication
public class SoapMockServerApplication {

    public static void main(String[] args) {
        SpringApplication.run(SoapMockServerApplication.class, args);
    }
}
```

## 3ï¸âƒ£ **WebServiceConfig.java**

```java
package com.example.soapmock.config;

import org.springframework.boot.web.servlet.ServletRegistrationBean;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.io.ClassPathResource;
import org.springframework.ws.config.annotation.EnableWs;
import org.springframework.ws.config.annotation.WsConfigurerAdapter;
import org.springframework.ws.server.EndpointInterceptor;
import org.springframework.ws.transport.http.MessageDispatcherServlet;
import org.springframework.ws.wsdl.wsdl11.SimpleWsdl11Definition;
import org.springframework.ws.wsdl.wsdl11.Wsdl11Definition;

import java.util.List;

/**
 * Web Service Configuration
 * Configures SOAP endpoints and WSDL exposure
 */
@EnableWs
@Configuration
public class WebServiceConfig extends WsConfigurerAdapter {

    private final SoapLoggingInterceptor loggingInterceptor;

    public WebServiceConfig(SoapLoggingInterceptor loggingInterceptor) {
        this.loggingInterceptor = loggingInterceptor;
    }

    /**
     * Registers the MessageDispatcherServlet
     */
    @Bean
    public ServletRegistrationBean<MessageDispatcherServlet> messageDispatcherServlet(
            ApplicationContext applicationContext) {
        MessageDispatcherServlet servlet = new MessageDispatcherServlet();
        servlet.setApplicationContext(applicationContext);
        servlet.setTransformWsdlLocations(true);
        return new ServletRegistrationBean<>(servlet, "/ws/*");
    }

    /**
     * Exposes WSDL at /ws/soapha.wsdl
     */
    @Bean(name = "soapha")
    public Wsdl11Definition defaultWsdl11Definition() {
        SimpleWsdl11Definition wsdl11Definition = new SimpleWsdl11Definition();
        wsdl11Definition.setWsdl(new ClassPathResource("wsdl/soapha.wsdl"));
        return wsdl11Definition;
    }

    /**
     * Adds logging interceptor to all SOAP requests
     */
    @Override
    public void addInterceptors(List<EndpointInterceptor> interceptors) {
        interceptors.add(loggingInterceptor);
    }
}
```

## 4ï¸âƒ£ **SoapLoggingInterceptor.java**

```java
package com.example.soapmock.config;

import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Component;
import org.springframework.ws.context.MessageContext;
import org.springframework.ws.server.EndpointInterceptor;
import org.springframework.ws.soap.SoapMessage;

import java.io.ByteArrayOutputStream;

/**
 * SOAP Logging Interceptor
 * Logs all incoming and outgoing SOAP messages
 */
@Slf4j
@Component
public class SoapLoggingInterceptor implements EndpointInterceptor {

    @Override
    public boolean handleRequest(MessageContext messageContext, Object endpoint) {
        logSoapMessage("Incoming SOAP Request", messageContext);
        return true;
    }

    @Override
    public boolean handleResponse(MessageContext messageContext, Object endpoint) {
        logSoapMessage("Outgoing SOAP Response", messageContext);
        return true;
    }

    @Override
    public boolean handleFault(MessageContext messageContext, Object endpoint) {
        log.error("SOAP Fault occurred");
        logSoapMessage("SOAP Fault", messageContext);
        return true;
    }

    @Override
    public void afterCompletion(MessageContext messageContext, Object endpoint, Exception ex) {
        if (ex != null) {
            log.error("Error processing SOAP message", ex);
        }
    }

    private void logSoapMessage(String prefix, MessageContext messageContext) {
        try {
            SoapMessage message = (SoapMessage) messageContext.getRequest();
            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
            message.writeTo(outputStream);
            String payload = outputStream.toString();
            log.info("{}: \n{}", prefix, payload);
        } catch (Exception e) {
            log.warn("Could not log SOAP message: {}", e.getMessage());
        }
    }
}
```

## 5ï¸âƒ£ **MockSoapEndpoint.java**

```java
package com.example.soapmock.endpoint;

import lombok.extern.slf4j.Slf4j;
import org.springframework.core.io.ClassPathResource;
import org.springframework.util.StreamUtils;
import org.springframework.ws.server.endpoint.annotation.Endpoint;
import org.springframework.ws.server.endpoint.annotation.PayloadRoot;
import org.springframework.ws.server.endpoint.annotation.RequestPayload;
import org.springframework.ws.server.endpoint.annotation.ResponsePayload;
import org.w3c.dom.Document;
import org.w3c.dom.Element;

import javax.annotation.PostConstruct;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import java.io.ByteArrayInputStream;
import java.nio.charset.StandardCharsets;

/**
 * Mock SOAP Endpoint
 * Returns predefined mock response for all SOAP requests
 */
@Slf4j
@Endpoint
public class MockSoapEndpoint {

    private static final String NAMESPACE_URI = "urn:swift:saa:xsd:soapha";
    private String mockResponseXml;

    @PostConstruct
    public void init() throws Exception {
        ClassPathResource resource = new ClassPathResource("mock/response.xml");
        mockResponseXml = StreamUtils.copyToString(
                resource.getInputStream(),
                StandardCharsets.UTF_8
        );
        log.info("Mock response loaded successfully from classpath");
    }

    /**
     * Handles GetAck requests
     */
    @PayloadRoot(namespace = NAMESPACE_URI, localPart = "GetAck")
    @ResponsePayload
    public Element handleGetAckRequest(@RequestPayload Element request) throws Exception {
        log.info("Received GetAck request, returning mock response");
        return parseResponseToElement();
    }

    /**
     * Handles all other requests with wildcard
     */
    @PayloadRoot(namespace = NAMESPACE_URI, localPart = "*")
    @ResponsePayload
    public Element handleAllRequests(@RequestPayload Element request) throws Exception {
        log.info("Received SOAP request: {}, returning mock response", 
                request.getLocalName());
        return parseResponseToElement();
    }

    /**
     * Parses the mock XML response into a DOM Element
     */
    private Element parseResponseToElement() throws Exception {
        // Extract only the GetAckResponse body content
        String bodyContent = extractBodyContent(mockResponseXml);
        
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        factory.setNamespaceAware(true);
        DocumentBuilder builder = factory.newDocumentBuilder();
        
        Document doc = builder.parse(
                new ByteArrayInputStream(bodyContent.getBytes(StandardCharsets.UTF_8))
        );
        
        return doc.getDocumentElement();
    }

    /**
     * Extracts SOAP Body content from the complete envelope
     */
    private String extractBodyContent(String soapEnvelope) {
        String bodyStartTag = "<SOAP-ENV:Body>";
        String bodyEndTag = "</SOAP-ENV:Body>";
        
        int startIndex = soapEnvelope.indexOf(bodyStartTag);
        int endIndex = soapEnvelope.indexOf(bodyEndTag);
        
        if (startIndex != -1 && endIndex != -1) {
            startIndex += bodyStartTag.length();
            return soapEnvelope.substring(startIndex, endIndex).trim();
        }
        
        log.warn("Could not extract body content, returning entire response");
        return soapEnvelope;
    }
}
```

## 6ï¸âƒ£ **application.yml**

```yaml
server:
  port: 8080
  servlet:
    context-path: /

spring:
  application:
    name: soap-mock-server
  
  web:
    resources:
      add-mappings: true

# Logging Configuration
logging:
  level:
    root: INFO
    com.example.soapmock: DEBUG
    org.springframework.ws: DEBUG
    org.springframework.ws.server.endpoint: TRACE
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always

# Application Info
info:
  app:
    name: SOAP Mock Server
    description: Mock server for SWIFT camt.053 messages
    version: 1.0.0
```

## 7ï¸âƒ£ **SoapMockServerApplicationTests.java**

```java
package com.example.soapmock;

import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ActiveProfiles;

@SpringBootTest
@ActiveProfiles("test")
class SoapMockServerApplicationTests {

    @Test
    void contextLoads() {
        // Verifies that the application context loads successfully
    }
}
```

## 8ï¸âƒ£ **README.md**

```markdown
# SOAP Mock Server

Mock server for SWIFT camt.053 SOAP messages using Spring Boot 3.x and Java 17.

## ğŸš€ Features

- âœ… Returns fixed SWIFT camt.053 response
- âœ… WSDL exposure at `/ws/soapha.wsdl`
- âœ… Request/Response logging
- âœ… Health check endpoints
- âœ… Clean code architecture
- âœ… Java 17 & Spring Boot 3.x

## ğŸ“‹ Prerequisites

- Java 17+
- Maven 3.8+

## ğŸ› ï¸ Build & Run

```bash
# Build the project
mvn clean install

# Run the application
mvn spring-boot:run
```

The server will start on `http://localhost:8080`

## ğŸ“¡ Endpoints

- **SOAP Endpoint**: `http://localhost:8080/ws`
- **WSDL**: `http://localhost:8080/ws/soapha.wsdl`
- **Health Check**: `http://localhost:8080/actuator/health`

## ğŸ§ª Testing with cURL

```bash
curl -X POST http://localhost:8080/ws \
  -H "Content-Type: text/xml; charset=utf-8" \
  -H "SOAPAction: GetAck" \
  -d @request.xml
```

## ğŸ§ª Testing with SoapUI

1. Create new SOAP project
2. Import WSDL: `http://localhost:8080/ws/soapha.wsdl`
3. Send request to: `http://localhost:8080/ws`

## ğŸ“ Project Structure

```
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â””â”€â”€ com/example/soapmock/
â”‚   â”‚       â”œâ”€â”€ SoapMockServerApplication.java
â”‚   â”‚       â”œâ”€â”€ config/
â”‚   â”‚       â”‚   â”œâ”€â”€ WebServiceConfig.java
â”‚   â”‚       â”‚   â””â”€â”€ SoapLoggingInterceptor.java
â”‚   â”‚       â””â”€â”€ endpoint/
â”‚   â”‚           â””â”€â”€ MockSoapEndpoint.java
â”‚   â””â”€â”€ resources/
â”‚       â”œâ”€â”€ application.yml
â”‚       â”œâ”€â”€ wsdl/
â”‚       â”‚   â””â”€â”€ soapha.wsdl
â”‚       â””â”€â”€ mock/
â”‚           â””â”€â”€ response.xml
```

## ğŸ”§ Configuration

Edit `application.yml` to customize:
- Server port
- Logging levels
- Context path

## ğŸ“ License

MIT License
```

## 9ï¸âƒ£ **Dosya YerleÅŸtirme TalimatlarÄ±**

### **WSDL DosyasÄ±**
`wsdl.txt` dosyanÄ±zÄ± ÅŸu ÅŸekilde yerleÅŸtirin:
```
src/main/resources/wsdl/soapha.wsdl
```

### **Response DosyasÄ±**
`Untitled-1.txt` dosyanÄ±zÄ± ÅŸu ÅŸekilde yerleÅŸtirin:
```
src/main/resources/mock/response.xml
```

## ğŸ¯ KullanÄ±m

```bash
# 1. Projeyi build edin
mvn clean package

# 2. Ã‡alÄ±ÅŸtÄ±rÄ±n
java -jar target/soap-mock-server-1.0.0.jar

# veya
mvn spring-boot:run
```

## âœ… Test

```bash
# WSDL kontrolÃ¼
curl http://localhost:8080/ws/soapha.wsdl

# Health check
curl http://localhost:8080/actuator/health

# SOAP Request (Ã¶rnek)
curl -X POST http://localhost:8080/ws \
  -H "Content-Type: text/xml" \
  -d '<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:saa="urn:swift:saa:xsd:soapha">
   <soapenv:Header/>
   <soapenv:Body>
      <saa:GetAck>
         <saa:SessionToken>test-token</saa:SessionToken>
      </saa:GetAck>
   </soapenv:Body>
</soapenv:Envelope>'
```

## ğŸ¨ Clean Code Ã–zellikleri

1. âœ… **SOLID Principles** - Single responsibility, dependency injection
2. âœ… **Separation of Concerns** - Config, endpoint, interceptor ayrÄ±mÄ±
3. âœ… **Meaningful Names** - AÃ§Ä±klayÄ±cÄ± sÄ±nÄ±f ve metod isimleri
4. âœ… **Logging** - Comprehensive logging with SLF4J
5. âœ… **Error Handling** - Exception handling ve graceful degradation
6. âœ… **Documentation** - JavaDoc ve README
7. âœ… **Testing Ready** - Test infrastructure hazÄ±r

Bu yapÄ± ile production-ready, maintainable ve scalable bir SOAP mock server'Ä±nÄ±z olacak! ğŸš€
